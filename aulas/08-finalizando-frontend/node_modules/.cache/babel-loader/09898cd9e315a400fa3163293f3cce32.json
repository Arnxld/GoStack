{"ast":null,"code":"var _jsxFileName = \"/home/pedro/Documents/gostack/aulas/08-finalizando-frontend/src/pages/Dashboard/index.tsx\";\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { isToday, format, isAfter, parseISO } from 'date-fns';\nimport ptBR from 'date-fns/locale/pt-BR';\nimport DayPicker from 'react-day-picker';\nimport 'react-day-picker/lib/style.css';\nimport { FiPower, FiClock } from 'react-icons/fi';\nimport { Container, Header, HeaderContent, Profile, Content, Schedule, NextAppointment, Section, Appointment, Calendar } from './styles';\nimport logoImg from \"../../assets/logo.svg\";\nimport { useAuth } from '../../hooks/auth';\nimport api from '../../services/apiClient';\n\nconst Dashboard = () => {\n  const [selectedDate, setSelectedDate] = useState(new Date());\n  const [currentMonth, setCurrentMonth] = useState(new Date());\n  const [monthAvailability, setMonthAvailability] = useState([]);\n  const [appointments, setAppointments] = useState([]);\n  const {\n    signOut,\n    user\n  } = useAuth();\n  const handleDateChange = useCallback((day, modifiers) => {\n    if (modifiers.available) {\n      setSelectedDate(day);\n    }\n\n    setSelectedDate(day);\n  }, []);\n  const handleMonthChange = useCallback(month => {\n    setCurrentMonth(month);\n  }, []);\n  useEffect(() => {\n    api.get(`/providers/${user.id}/month-availability`, {\n      params: {\n        year: currentMonth.getFullYear(),\n        month: currentMonth.getMonth() + 1\n      }\n    }).then(response => {\n      setMonthAvailability(response.data);\n    });\n  }, [currentMonth, user.id]);\n  useEffect(() => {\n    api.get('/appointments/me', {\n      params: {\n        year: selectedDate.getFullYear(),\n        month: selectedDate.getMonth() + 1,\n        day: selectedDate.getDate()\n      }\n    }).then(response => {\n      const appointmentsFormatted = response.data.map(appointment => {\n        return { ...appointment,\n          hourFormatted: format(parseISO(appointment.date), 'HH:mm')\n        };\n      });\n      setAppointments(appointmentsFormatted);\n    });\n  }, [selectedDate]);\n  const disabledDays = useMemo(() => {\n    const dates = monthAvailability.filter(monthDay => monthDay.available === false).map(monthDay => {\n      const year = currentMonth.getFullYear();\n      const month = currentMonth.getMonth();\n      return new Date(year, month, monthDay.day);\n    });\n    return dates;\n  }, [currentMonth, monthAvailability]);\n  const selectedDateAsText = useMemo(() => {\n    return format(selectedDate, \"'dia' dd 'de' MMMM\", {\n      locale: ptBR\n    });\n  }, [selectedDate]);\n  const selectedWeekDay = useMemo(() => {\n    return format(selectedDate, 'cccc', {\n      locale: ptBR\n    });\n  }, [selectedDate]);\n  const morningAppointments = useMemo(() => {\n    return appointments.filter(appointment => {\n      return parseISO(appointment.date).getHours() < 12;\n    });\n  }, [appointments]);\n  const afternoonAppointments = useMemo(() => {\n    return appointments.filter(appointment => {\n      return parseISO(appointment.date).getHours() >= 12;\n    });\n  }, [appointments]);\n  const nextAppointment = useMemo(() => {\n    return appointments.find(appointment => isAfter(parseISO(appointment.date), new Date()));\n  }, [appointments]);\n  return /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(HeaderContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: logoImg,\n    alt: \"GoBarber\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(Profile, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: user.avatar_url,\n    alt: user.name,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 29\n    }\n  }, \"Bem-vindo,\"), /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 29\n    }\n  }, user.name))), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    onClick: signOut,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(FiPower, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 25\n    }\n  })))), /*#__PURE__*/React.createElement(Content, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Schedule, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 21\n    }\n  }, \"Hor\\xE1rios Agendados\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 21\n    }\n  }, isToday(selectedDate) && /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 51\n    }\n  }, \"Hoje\"), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 25\n    }\n  }, selectedDateAsText), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 25\n    }\n  }, selectedWeekDay)), isToday(selectedDate) && nextAppointment && /*#__PURE__*/React.createElement(NextAppointment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 29\n    }\n  }, \"Agendamento a seguir\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: nextAppointment.user.avatar_url,\n    alt: nextAppointment.user.name,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 33\n    }\n  }), /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 33\n    }\n  }, nextAppointment.user.name), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(FiClock, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 37\n    }\n  }), nextAppointment.hourFormatted))), /*#__PURE__*/React.createElement(Section, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 25\n    }\n  }, \"Manh\\xE3\"), morningAppointments.length === 0 && /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 29\n    }\n  }, \"Nenhum agendamento neste per\\xEDodo\"), morningAppointments.map(appointment => /*#__PURE__*/React.createElement(Appointment, {\n    key: appointment.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(FiClock, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 37\n    }\n  }), appointment.hourFormatted), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: appointment.user.avatar_url,\n    alt: appointment.user.name,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 37\n    }\n  }), /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 37\n    }\n  }, appointment.user.name))))), /*#__PURE__*/React.createElement(Section, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 25\n    }\n  }, \"Tarde\"), afternoonAppointments.length === 0 && /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 29\n    }\n  }, \"Nenhum agendamento neste per\\xEDodo\"), afternoonAppointments.map(appointment => /*#__PURE__*/React.createElement(Appointment, {\n    key: appointment.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(FiClock, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 37\n    }\n  }), appointment.hourFormatted), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: appointment.user.avatar_url,\n    alt: appointment.user.name,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 37\n    }\n  }), /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 37\n    }\n  }, appointment.user.name)))))), /*#__PURE__*/React.createElement(Calendar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(DayPicker, {\n    weekdaysShort: ['D', 'S', 'T', 'Q', 'Q', 'S', 'S'],\n    fromMonth: new Date(),\n    disabledDays: [{\n      daysOfWeek: [0, 6]\n    }, ...disabledDays],\n    selectedDays: selectedDate,\n    modifiers: {\n      available: {\n        daysOfWeek: [1, 2, 3, 4, 5]\n      }\n    },\n    onDayClick: handleDateChange,\n    onMonthChange: handleMonthChange,\n    months: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 21\n    }\n  }))));\n};\n\nexport default Dashboard;","map":{"version":3,"sources":["/home/pedro/Documents/gostack/aulas/08-finalizando-frontend/src/pages/Dashboard/index.tsx"],"names":["React","useCallback","useEffect","useMemo","useState","isToday","format","isAfter","parseISO","ptBR","DayPicker","FiPower","FiClock","Container","Header","HeaderContent","Profile","Content","Schedule","NextAppointment","Section","Appointment","Calendar","useAuth","api","Dashboard","selectedDate","setSelectedDate","Date","currentMonth","setCurrentMonth","monthAvailability","setMonthAvailability","appointments","setAppointments","signOut","user","handleDateChange","day","modifiers","available","handleMonthChange","month","get","id","params","year","getFullYear","getMonth","then","response","data","getDate","appointmentsFormatted","map","appointment","hourFormatted","date","disabledDays","dates","filter","monthDay","selectedDateAsText","locale","selectedWeekDay","morningAppointments","getHours","afternoonAppointments","nextAppointment","find","logoImg","avatar_url","name","length","daysOfWeek"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { isToday, format, isAfter, parseISO} from 'date-fns';\nimport ptBR from 'date-fns/locale/pt-BR';\nimport DayPicker, { DayModifiers } from 'react-day-picker';\nimport 'react-day-picker/lib/style.css'\n\nimport { FiPower, FiClock } from 'react-icons/fi';\nimport { \n    Container, \n    Header, \n    HeaderContent, \n    Profile, \n    Content, \n    Schedule, \n    NextAppointment,\n    Section,\n    Appointment,\n    Calendar,\n} from './styles';\n\nimport logoImg from '../../assets/logo.svg';\nimport { useAuth } from '../../hooks/auth';\nimport api from '../../services/apiClient';\n\ninterface MonthAvailabilityItem {\n    day: number;\n    available: boolean;\n}\n\ninterface Appointment {\n    id: string;\n    date: string;\n    hourFormatted: string;\n    user: {\n        name: string;\n        avatar_url: string;\n    }\n}\nconst Dashboard: React.FC = () => {\n\n    const [selectedDate, setSelectedDate] = useState(new Date());\n    const [currentMonth, setCurrentMonth] = useState(new Date());\n\n    const [monthAvailability, setMonthAvailability] = useState<MonthAvailabilityItem[]>([]);\n\n    const [appointments, setAppointments] = useState<Appointment[]>([])\n\n    \n\n    const { signOut, user } = useAuth();\n\n    const handleDateChange = useCallback((day: Date, modifiers: DayModifiers) => {\n        if (modifiers.available) {\n            setSelectedDate(day)\n        }\n        \n        setSelectedDate(day);\n    }, [])\n\n    const handleMonthChange = useCallback((month: Date) => {\n        setCurrentMonth(month)\n    }, [])\n\n    useEffect(() => {\n        api.get(`/providers/${user.id}/month-availability`, {\n            params: {\n               year: currentMonth.getFullYear(),\n               month: currentMonth.getMonth() + 1,\n            }\n        }).then(response => {\n            setMonthAvailability(response.data)\n        })\n    }, [currentMonth, user.id])\n\n    useEffect(() => {\n        api.get<Appointment[]>('/appointments/me', {\n            params: {\n                year: selectedDate.getFullYear(),\n                month: selectedDate.getMonth() + 1,\n                day: selectedDate.getDate(),\n            }\n        }).then(response => {\n            const appointmentsFormatted = response.data.map(appointment => {\n                return {\n                    ...appointment,\n                    hourFormatted: format(parseISO(appointment.date), 'HH:mm'),\n                }\n            })\n\n            setAppointments(appointmentsFormatted)\n        })\n    }, [selectedDate])\n\n    const disabledDays = useMemo(() => {\n        const dates = monthAvailability.filter(monthDay => monthDay.available === false)\n        .map(monthDay => {\n            const year = currentMonth.getFullYear();\n            const month = currentMonth.getMonth();\n            return new Date(year, month, monthDay.day)\n        });\n\n        return dates\n    }, [currentMonth, monthAvailability])\n\n    const selectedDateAsText = useMemo(() => {\n        return format(selectedDate, \"'dia' dd 'de' MMMM\", {\n            locale: ptBR\n        })\n    }, [selectedDate])\n\n    const selectedWeekDay = useMemo(() => {\n        return format(selectedDate, 'cccc', {\n            locale: ptBR\n        })\n    }, [selectedDate])\n\n    const morningAppointments = useMemo(() => {\n        return appointments.filter(appointment => {\n            return parseISO(appointment.date).getHours() < 12\n        })\n    }, [appointments])\n\n    const afternoonAppointments = useMemo(() => {\n        return appointments.filter(appointment => {\n            return parseISO(appointment.date).getHours() >= 12\n        })\n    }, [appointments])\n\n    const nextAppointment = useMemo(() => {\n        return appointments.find(appointment =>\n            isAfter(parseISO(appointment.date), new Date()),\n        )\n    }, [appointments])\n\n    return (\n        <Container>\n            <Header>\n                <HeaderContent>\n                    <img src={logoImg} alt=\"GoBarber\"/>\n\n                    <Profile>\n                        <img src={user.avatar_url} alt={user.name} />\n                \n                        <div>\n                            <span>Bem-vindo,</span>\n                            <strong>{user.name}</strong>\n                        </div>\n                    </Profile>\n\n                    <button type=\"button\" onClick={signOut}>\n                        <FiPower />\n                    </button>\n                </HeaderContent>\n            </Header>\n\n            <Content>\n                <Schedule>\n                    <h1>Horários Agendados</h1>\n                    <p>\n                        {isToday(selectedDate) && <span>Hoje</span>}\n                        <span>{selectedDateAsText}</span>\n                        <span>{selectedWeekDay}</span>\n                    </p>\n\n                    {isToday(selectedDate) && nextAppointment && (\n                        <NextAppointment>\n                            <strong>Agendamento a seguir</strong>\n                            <div>\n                                <img src={nextAppointment.user.avatar_url} alt={nextAppointment.user.name}/>\n                            \n                                <strong>{nextAppointment.user.name}</strong>\n                                <span>\n                                    <FiClock />\n                                    {nextAppointment.hourFormatted}\n                                </span>\n                            \n                            </div>\n                        </NextAppointment>\n                    )}\n\n                    \n                \n                    <Section>\n                        <strong>Manhã</strong>\n\n                        {morningAppointments.length === 0 && (\n                            <p>Nenhum agendamento neste período</p>\n                        )}\n\n                        {morningAppointments.map(appointment => (\n                            <Appointment key={appointment.id}>\n                                <span>\n                                    <FiClock />\n                                    {appointment.hourFormatted}\n                                </span>\n\n                                <div>\n                                    <img src={appointment.user.avatar_url} alt={appointment.user.name}/>\n                                    <strong>{appointment.user.name}</strong>\n                                </div>\n                            </Appointment>\n                        ))}\n                    </Section>\n                    <Section>\n                        <strong>Tarde</strong>\n\n                        {afternoonAppointments.length === 0 && (\n                            <p>Nenhum agendamento neste período</p>\n                        )}\n\n                        {afternoonAppointments.map(appointment => (\n                            <Appointment key={appointment.id}>\n                                <span>\n                                    <FiClock />\n                                    {appointment.hourFormatted}\n                                </span>\n\n                                <div>\n                                    <img src={appointment.user.avatar_url} alt={appointment.user.name}/>\n                                    <strong>{appointment.user.name}</strong>\n                                </div>\n                            </Appointment>\n                        ))}\n                    </Section>\n                </Schedule>\n                <Calendar>\n                    <DayPicker \n                        weekdaysShort={['D', 'S', 'T', 'Q', 'Q', 'S', 'S']}\n                        fromMonth={new Date()}\n                        disabledDays={[\n                            { daysOfWeek: [0, 6]},\n                            ...disabledDays\n                        ]}\n                        selectedDays={selectedDate}\n                        modifiers={{\n                            available: { daysOfWeek: [1, 2, 3, 4, 5]}\n                        }}\n                        onDayClick={handleDateChange}\n                        onMonthChange={handleMonthChange}\n                        months={[\n                            'Janeiro',\n                            'Fevereiro',\n                            'Março',\n                            'Abril',\n                            'Maio',\n                            'Junho',\n                            'Julho',\n                            'Agosto',\n                            'Setembro',\n                            'Outubro',\n                            'Novembro',\n                            'Dezembro'\n                        ]}\n                    />\n                </Calendar>\n            </Content>\n        </ Container>\n    )\n}\n\nexport default Dashboard;\n"]},"metadata":{},"sourceType":"module"}